# Spread Aggregator: Новостное агентство 2.0

## 1. Открытие агентства (Запуск Program.cs)
- **Сбор команды**
  - Корреспонденты (Exchange Clients)
  - Аналитик (SpreadCalculator)
  - Охранник (VolumeFilter)
  - Ведущий прямого эфира (FleckWebSocketServer)
  - Смотритель за архивом (DataCollectorService)
- **Создание "почтового ящика" (Channel)**
- **Запуск отделов (параллельно)**
  - Отдел прямого эфира
  - Архивный отдел

## 2. Отдел прямого эфира (OrchestrationService)
- **Управление процессом в реальном времени**
- **Инструктаж корреспондентов**
  - Найти ликвидные монеты
  - Подписаться на обновления цен и сделок
- **Поток новостей**
  - Корреспонденты отправляют "сырые" данные в "почтовый ящик" (Channel)
- **Обработка для эфира**
  - Взять копию новости
  - Рассчитать спред (Аналитик)
  - Передать ведущему для трансляции

## 3. Архивный отдел (DataCollectorService)
- **Работа в фоновом режиме**
- **Разбор "почтового ящика" (Channel)**
  - Забирает "сырые" данные, как только они появляются
- **Сортировка и запись в архив**
  - Создает папки (биржа, монета, дата, час)
  - Записывает данные в `.parquet` файлы
  - Работает порциями (пачками) для эффективности

## Ключевая особенность: Параллелизм
- **Отдел прямого эфира** не ждет **Архивный отдел**.
- Это обеспечивает максимальную скорость и надежность.