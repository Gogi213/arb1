graph TD
    subgraph Initialization
        A[Start App with 'bybit' or 'gate' arg] --> B(Load ExchangeConfig from appsettings.json)
        B --> C(Initialize IExchange Implementation e.g., BybitExchange)
        C --> D(Initialize ConvergentTrader with IExchange)
    end

    subgraph "Execution Loop (RunManualConvergentTrader)"
        D --> E(Start ConvergentTrader)
        E --> F(Cancel All Open Orders)
        F --> G(Delegate to TrailingTrader to place BUY order)
        G --> H{Wait for Buy Order Fill event}
        H --> I(Handle Buy Fill: Record Quantity)
        I --> J(Wait for Balance Update Confirmation via WebSocket)
        J --> K(Wait for 5-second Hardcoded Delay)
        K --> L(Place Market SELL Order for entire available balance)
        L --> M(Assume Sell Order Fills after 1s Delay)
        M --> N(Estimate P&L)
        N --> O[Cycle Complete]
    end