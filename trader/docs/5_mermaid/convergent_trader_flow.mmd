graph TD
    subgraph "1. Startup"
        A[Start with 'bybit' or 'gate' arg] --> B{RunManualConvergentTrader};
        B --> C[Instantiate IExchange];
        C --> D[Instantiate ConvergentTrader];
    end

    subgraph "2. Trading Cycle (ConvergentTrader)"
        D --> E{StartAsync};
        E --> F[Cancel Open Orders];
        F --> G[Start TrailingTrader for BUY];
        G --> H{OnOrderFilled (BUY)};
        H --> I[Wait for Balance Update];
        I --> J[Wait 5 seconds];
        J --> K[Place Market SELL Order];
        K --> L{Assume Sell Fill};
        L --> M[Cycle Complete];
    end

    style G fill:#cde,stroke:#333,stroke-width:2px
    style K fill:#f99,stroke:#333,stroke-width:2px