graph TD
    subgraph "1. Setup (No CLI Args)"
        A[Start Application] --> B{Instantiate SpreadListener};
        B --> C{Instantiate DecisionMaker};
        C --> D[DecisionMaker subscribes to Listener];
    end

    subgraph "2. Spread Detection (SpreadListener)"
        D --> E[Connect to SpreadAggregator WS];
        E --> F{Receive SpreadData};
        F -- Spread > Threshold --> G[Fire OnProfitableSpreadDetected];
    end

    subgraph "3. Decision (DecisionMaker)"
        G --> H{HandleProfitableSpread};
        H --> I{Check _isCycleInProgress flag};
        I -- "false" --> J[Log opportunity];
        J --> K[Set _isCycleInProgress = true];
        I -- "true" --> L[Ignore signal];
    end

    subgraph "4. Execution (Not Implemented)"
        K --> M(TODO: Start ArbitrageTrader);
    end

    style M fill:#f00,stroke:#333,stroke-width:4px