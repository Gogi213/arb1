# Аудит Кода и План Рефакторинга - 30 Октября 2025

**Цель:** Выявить ключевые архитектурные проблемы и сформировать приоритетный план по их устранению.

---

### Приоритетные Задачи Рефакторинга

**Приоритет 1: Устранение дублирования кода и избыточных слоев (Высокий)**

Это основная группа задач, направленная на кардинальное упрощение архитектуры.

1.  **Объединение Трейдеров:**
    -   **Проблема:** Классы `ArbitrageTrader` и `ReverseArbitrageTrader` являются почти полной копией друг друга. То же самое касается `TrailingTrader` и `BybitTrailingTrader`.
    -   **Решение:** Создать общий базовый класс `BaseArbitrageTrader` и использовать единый `TrailingTrader`, как описано в предыдущих пунктах аудита.

2.  **Упрощение абстракций:**
    -   **Проблема:** `ITrader` является избыточным интерфейсом. `BybitExchange` — ненужная обертка.
    -   **Решение:** Удалить `ITrader` и `BybitExchange`. Заставить `BybitLowLatencyWs` напрямую реализовывать `IExchange`.

3.  **Корректировка структуры проекта:**
    -   **Проблема:** `ReverseArbitrageTrader.cs` находится в нелогичном месте.
    -   **Решение:** Переместить `ReverseArbitrageTrader.cs` в директорию `Core`.

**Приоритет 2: Рефакторинг точки входа (Средний)**

-   **Проблема:** `Program.cs` жестко связывает компоненты и содержит бизнес-логику.
-   **Решение:** Внедрить DI-контейнер и вынести логику оркестрации в отдельный класс `Orchestrator`.

---

### Задачи с Низким Приоритетом (Технический долг)

Следующие пункты были выявлены в ходе аудита, но по согласованию отложены, так как текущая реализация считается приемлемой для данного этапа разработки:

-   **Глубокий рефакторинг `BybitLowLatencyWs`:** Разделение этого класса на более мелкие компоненты на данный момент не требуется.
-   **"Косметические" исправления:** Замена `async void` на `async Task` и вынос "магических чисел" в конфигурацию могут быть выполнены в плановом порядке в будущем.
