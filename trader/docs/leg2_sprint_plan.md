# План спринтов для реализации "Leg 2" (Bybit -> Gate.io)

## Общий статус: МЕХАНИКА ЗАВЕРШЕНА

**Ключевые цели достигнуты:** Полный арбитражный цикл "покупка на Bybit -> продажа на Gate.io" успешно реализован и протестирован. Основные проблемы, включая подписку на стакан Bybit и корректную обработку ордеров на продажу в Gate.io, решены.

**Текущий фокус:** Настройка и оптимизация объемов торгов.

---

### Спринт 1: Инфраструктура и отладка подписки

*   `[x]` **ReverseArbitrageTrader**: Реализован базовый класс, конструктор и логика подписок.
*   `[x]` **BybitTrailingTrader**: Реализована логика трейлинг-покупки на Bybit.
*   `[x]` **BybitLowLatencyWs**: Реализована и отлажена подписка на стакан (`orderbook`). Данные успешно поступают.
*   `[x]` **Host (`Program.cs`)**: Исправлена критическая ошибка с жизненным циклом. Приложение корректно ожидает завершения `Leg 2`.

**Итог спринта:** Вся базовая инфраструктура для `Leg 2` готова. Критические блокировщики устранены.

---

### Спринт 2: Тестирование полного цикла и исправления

*   `[x]` **Размещение ордера на Bybit:** Успешно выполнено.
*   `[x]` **HandleBuyOrderFilled**: Успешно обрабатывает исполненный ордер на покупку.
*   `[x]` **Размещение ордера на продажу на Gate.io:** Успешно выполнено.
*   `[x]` **HandleSellOrderUpdate**: Успешно обрабатывает подтверждение о продаже с Gate.io.

**Цель спринта:** Добиться выполнения одного полного арбитражного цикла "покупка на Bybit -> продажа на Gate.io".

---

### Спринт 3: Завершение и рефакторинг

*   `[x]` **Latency**: Расчет End-to-End Latency реализован и работает.
*   `[x]` **Cleanup**: Логика `CleanupAndSignalCompletionAsync` успешно протестирована.
*   `[ ]` **Рефакторинг (To Do)**: Вынести "магические числа" и хардкод (размер ордера, тикеры, фильтры) в конфигурацию (задачи `TD-002`, `TD-005` из бэклога).