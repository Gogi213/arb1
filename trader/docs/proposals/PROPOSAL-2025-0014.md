# PROPOSAL-2025-0014: Добавление отладочного логирования перед продажей на Gate.io

## 1. Диагностика

- **Файлы:** `trader/src/Exchanges/Bybit/ReverseArbitrageTrader.cs`
- **Проблема:** Неизвестно, какое точное значение `sellQuantity` передается в `_gateIoExchange.PlaceOrderAsync`, что мешает диагностировать ошибку `order size 0 H is too small`.
- **Серьезность:** `medium`

## 2. Предлагаемые изменения

Предлагается добавить строку для вывода в консоль значения `sellQuantity` непосредственно перед вызовом `PlaceOrderAsync`.

```diff
--- a/trader/src/Exchanges/Bybit/ReverseArbitrageTrader.cs
+++ b/trader/src/Exchanges/Bybit/ReverseArbitrageTrader.cs
@@ -145,6 +145,8 @@
                  // Use the actual filled quantity from the Bybit order
                  var sellQuantity = filledOrder.Quantity;
  
+                 Console.WriteLine($"[Y5 DEBUG] Attempting to sell {sellQuantity} of {sellSymbol} on Gate.io");
+
                  var t2 = DateTime.UtcNow;
                  var sellOrderId = await _gateIoExchange.PlaceOrderAsync(
                      sellSymbol,

```

### Обоснование

Это изменение позволит нам увидеть в логах точное значение, которое используется для создания ордера на продажу. Это первый и самый важный шаг для проверки всех гипотез, перечисленных в `ISSUE-003`.

## 3. Шаги для отката

Выполнить команду в корне проекта:
`git checkout -- trader/src/Exchanges/Bybit/ReverseArbitrageTrader.cs`

## 4. Оценка рисков

- **Риск:** Нулевой.
- **Обоснование:** Добавляется только одна строка для вывода в консоль, что не влияет на логику работы.

## 5. План тестирования

1.  Применить изменение.
2.  Запустить приложение с активным `Leg 2`.
3.  Спровоцировать исполнение ордера на покупку на Bybit.
4.  Найти в логах сообщение `[Y5 DEBUG]` и проверить значение `sellQuantity`.