# PROPOSAL-2025-0051: Add Diagnostic Logging to BybitOrderUpdate Constructor

## 1. Диагностика

Мои предыдущие попытки исправить парсинг `cumExecValue` провалились. Повторять те же действия бессмысленно. Текущая гипотеза: происходит сбой на этапе десериализации JSON в конструкторе `BybitOrderUpdate`, но он происходит "молча", без ошибок, возвращая `0`.

Чтобы подтвердить или опровергнуть это, необходимо добавить временное, детальное логирование в проблемный участок кода.

## 2. Предлагаемое изменение

Это изменение не исправляет логику, а добавляет три строки логов для точной диагностики проблемы парсинга.

### `trader/src/Exchanges/Bybit/BybitLowLatencyWs.cs`

```diff
<<<<<<< SEARCH
:start_line:736
-------
            CumulativeExecutedValue = data.TryGetProperty("cumExecValue", out var cev) && decimal.TryParse(cev.GetString(), out var ceValue) ? ceValue : 0;
            QuoteQuantity = CumulativeExecutedValue;
            CumulativeQuoteQuantity = CumulativeExecutedValue;
=======
            var hasValue = data.TryGetProperty("cumExecValue", out var cev);
            var rawValue = hasValue ? cev.GetString() : "NOT_FOUND";
            var didParse = decimal.TryParse(rawValue, out var ceValue);
            FileLogger.LogOther($"[DEBUG_PARSE] Has 'cumExecValue': {hasValue}, Raw: '{rawValue}', Parsed OK: {didParse}, Value: {ceValue}");

            CumulativeExecutedValue = didParse ? ceValue : 0;
            QuoteQuantity = CumulativeExecutedValue;
            CumulativeQuoteQuantity = CumulativeExecutedValue;
>>>>>>> REPLACE
```

## 3. Обоснование

Этот подход соответствует принципу "Hypothesis-Driven Debugging". Вместо слепого исправления мы собираем конкретные данные. Новые логи покажут нам, на каком именно этапе происходит сбой:
-   Не находится поле `cumExecValue`?
-   Поле приходит, но в неверном формате (например, с запятой вместо точки)?
-   `decimal.TryParse` не справляется по культурным причинам?

Ответы на эти вопросы дадут точную причину проблемы.

## 4. Оценка рисков

-   **Риск:** Нулевой. Изменение только добавляет логирование и не меняет основную логику. Это временная диагностическая мера.

## 5. План тестирования

1.  Утвердить и применить изменение.
2.  Запустить сборку и выполнение.
3.  Проанализировать лог `other.txt` на наличие новых строк `[DEBUG_PARSE]`.
4.  **Ожидаемый результат:** Мы увидим детальную информацию о процессе парсинга, которая укажет на точную причину, почему `CumulativeQuoteQuantity` остаётся нулевым.

## 6. План отката

-   Удалить добавленные строки логирования из конструктора `BybitOrderUpdate`.