# –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–û–ë–õ–ï–ú–´ OUT-OF-MEMORY (OOM)

**–î–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞:** 2025-11-08
**–ü—Ä–æ–µ–∫—Ç—ã:** charts/ (Python), collections/ (C#)
**–°—Ç–∞—Ç—É—Å:** üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô

---

## EXECUTIVE SUMMARY

–û–±–Ω–∞—Ä—É–∂–µ–Ω–æ **10 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º**, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ OOM –≤ production:

| –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –ü—Ä–æ–±–ª–µ–º–∞ | Impact | –ü—Ä–æ–µ–∫—Ç |
|-----------|----------|--------|--------|
| üî¥ P0 | Unbounded Channels (–±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π) | **‚àû GB** | Collections |
| üî¥ P0 | _allSymbolInfo —Ä–∞—Å—Ç–µ—Ç –±–µ–∑ –æ—á–∏—Å—Ç–∫–∏ | **‚àû GB** | Collections |
| üî¥ P0 | MOCK_OPPORTUNITIES –Ω–µ –æ—á–∏—â–∞–µ—Ç—Å—è | **2-4 GB** | Charts |
| üü† P1 | RollingWindow –º–æ–∂–µ—Ç —Ä–∞—Å—Ç–∏ –±–µ—Å–∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–æ | **10-50 GB** | Both |
| üü† P1 | Dead WebSocket connections | **200+ MB** | Both |
| üü† P1 | Task.WhenAll –±–ª–æ–∫–∏—Ä—É–µ—Ç –Ω–∞ –º–µ–¥–ª–µ–Ω–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–∞—Ö | Performance | Collections |
| üü° P2 | ParquetDataWriter buffers | **200-300 MB** | Collections |
| üü° P2 | JSON —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è - –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö | **6.6 GB/hour** | Both |

**–°–æ–≤–æ–∫—É–ø–Ω—ã–π —Ä–∏—Å–∫:** –ù–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π —Ä–æ—Å—Ç –ø–∞–º—è—Ç–∏ ‚Üí OOM crash –≤ —Ç–µ—á–µ–Ω–∏–µ 1-24 —á–∞—Å–æ–≤ –ø—Ä–∏ –ø–æ–ª–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–µ.

---

## üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–û–ë–õ–ï–ú–´ (P0)

### 1. Unbounded Channels –≤ Collections

**–§–∞–π–ª:** [Program.cs:72-73](../collections/src/SpreadAggregator.Presentation/Program.cs#L72-L73)

```csharp
services.AddSingleton<RawDataChannel>(
    new RawDataChannel(Channel.CreateUnbounded<MarketData>())
);
services.AddSingleton<RollingWindowChannel>(
    new RollingWindowChannel(Channel.CreateUnbounded<MarketData>())
);
```

**–ü—Ä–æ–±–ª–µ–º–∞:**
- `CreateUnbounded<T>()` —Å–æ–∑–¥–∞–µ—Ç –æ—á–µ—Ä–µ–¥—å –ë–ï–ó –õ–ò–ú–ò–¢–ê —Ä–∞–∑–º–µ—Ä–∞
- –ï—Å–ª–∏ –ø–∏—Å–∞—Ç–µ–ª—å (OrchestrationService) –±—ã—Å—Ç—Ä–µ–µ —á–∏—Ç–∞—Ç–µ–ª—è ‚Üí –æ—á–µ—Ä–µ–¥—å —Ä–∞—Å—Ç–µ—Ç –¥–æ OOM
- –ü—Ä–∏ 8 –±–∏—Ä–∂–∞—Ö √ó 1000 –ø–∞—Ä √ó 100 ticks/sec = **800K —Å–æ–æ–±—â–µ–Ω–∏–π/—Å–µ–∫**
- –ï—Å–ª–∏ ParquetDataWriter –æ—Ç—Å—Ç–∞–µ—Ç: **9.4 GB –∑–∞ 1 –º–∏–Ω—É—Ç—É**

**–°—Ç–∞—Ç—É—Å:** –û–¢–ö–†–´–¢–û
**–†–∏—Å–∫:** –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô
**–§–∏–∫—Å:** –ó–∞–º–µ–Ω–∏—Ç—å –Ω–∞ `Channel.CreateBounded()` —Å capacity 10000-100000

---

### 2. List<SymbolInfo> —Ä–∞—Å—Ç–µ—Ç –±–µ–∑ –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏–∏

**–§–∞–π–ª:** [OrchestrationService.cs:27,84](../collections/src/SpreadAggregator.Application/Services/OrchestrationService.cs#L27)

```csharp
private readonly List<SymbolInfo> _allSymbolInfo = new();

// –í ProcessExchange():
_allSymbolInfo.AddRange(allSymbols);  // –¢–û–õ–¨–ö–û –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ!
```

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ü—Ä–∏ –∫–∞–∂–¥–æ–º –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –∫ –±–∏—Ä–∂–µ —Å–∏–º–≤–æ–ª—ã –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –ø–æ–≤—Ç–æ—Ä–Ω–æ
- –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ –¥—É–±–ª–∏–∫–∞—Ç—ã
- –ó–∞ 100 –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π: **800 MB** –¥—É–±–ª–∏–∫–∞—Ç–æ–≤

**–°—Ç–∞—Ç—É—Å:** –û–¢–ö–†–´–¢–û
**–†–∏—Å–∫:** –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô
**–§–∏–∫—Å:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å HashSet –∏–ª–∏ –¥–µ–¥—É–ø–ª–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –ø–µ—Ä–µ–¥ AddRange

---

### 3. –ì–ª–æ–±–∞–ª—å–Ω—ã–π MOCK_OPPORTUNITIES DataFrame

**–§–∞–π–ª:** [server.py:511,526](../charts/server.py#L511)

```python
MOCK_OPPORTUNITIES = None  # –ì–ª–æ–±–∞–ª—å–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è

# –í endpoint /api/test/load_mock_data:
MOCK_OPPORTUNITIES = pl.DataFrame(opp_data)  # –ú–æ–∂–µ—Ç –±—ã—Ç—å –≥–∏–≥–∞–Ω—Ç—Å–∫–∏–º
```

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –•—Ä–∞–Ω–∏—Ç –≤–µ—Å—å DataFrame –≤ –ø–∞–º—è—Ç–∏ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ
- –ù–µ –æ—á–∏—â–∞–µ—Ç—Å—è –ø—Ä–∏ shutdown
- –ú–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω—ã–µ –≤—ã–∑–æ–≤—ã —Å–æ–∑–¥–∞—é—Ç —É—Ç–µ—á–∫—É —á–µ—Ä–µ–∑ —Å—Ç–∞—Ä—ã–µ —Å—Å—ã–ª–∫–∏

**–°—Ç–∞—Ç—É—Å:** –û–¢–ö–†–´–¢–û
**–†–∏—Å–∫:** –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô
**–§–∏–∫—Å:** –û—á–∏—Å—Ç–∏—Ç—å –≤ shutdown hook, –¥–æ–±–∞–≤–∏—Ç—å –ª–∏–º–∏—Ç —Ä–∞–∑–º–µ—Ä–∞

---

## üü† –í–´–°–û–ö–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢ (P1)

### 4. RollingWindow –±–µ–∑ –∂–µ—Å—Ç–∫–æ–≥–æ –ª–∏–º–∏—Ç–∞

**–§–∞–π–ª—ã:**
- [server.py:61](../charts/server.py#L61) (Python)
- [RollingWindowService.cs:11](../collections/src/SpreadAggregator.Application/Services/RollingWindowService.cs#L11) (C#)

**–ü—Ä–æ–±–ª–µ–º–∞:**
- TTL 1 —á–∞—Å, –Ω–æ cleanup –∫–∞–∂–¥—ã–µ 60 —Å–µ–∫—É–Ω–¥
- –ï—Å–ª–∏ cleanup –æ—Ç—Å—Ç–∞–µ—Ç –∏–ª–∏ fails ‚Üí –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π —Ä–æ—Å—Ç
- –ü—Ä–∏ 8000 –ø–∞—Ä √ó 1 —á–∞—Å –¥–∞–Ω–Ω—ã—Ö = **10-50 GB**

**–°—Ç–∞—Ç—É—Å:** –°–†–ï–î–ù–ò–ô –†–ò–°–ö
**–§–∏–∫—Å:** –î–æ–±–∞–≤–∏—Ç—å –∂–µ—Å—Ç–∫–∏–π –ª–∏–º–∏—Ç –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–∫–æ–Ω (MAX_WINDOWS)

---

### 5. –ú–µ—Ä—Ç–≤—ã–µ WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è

**–§–∞–π–ª—ã:**
- [FleckWebSocketServer.cs:15,35,49](../collections/src/SpreadAggregator.Infrastructure/Services/FleckWebSocketServer.cs#L15)
- [server.py:176-177](../charts/server.py#L176-L177)

**–ü—Ä–æ–±–ª–µ–º–∞:**
- **Collections:** OnClose –º–æ–∂–µ—Ç –Ω–µ –≤—ã–∑–≤–∞—Ç—å—Å—è ‚Üí –º–µ—Ä—Ç–≤—ã–µ —Å–æ–∫–µ—Ç—ã –≤ _allSockets
- **Charts:** ping_interval=None ‚Üí dead connections –Ω–µ –¥–µ—Ç–µ–∫—Ç–∏—Ä—É—é—Ç—Å—è 10+ –º–∏–Ω—É—Ç
- 100 –º–µ—Ä—Ç–≤—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π √ó 2 MB = **200 MB** —É—Ç–µ—á–∫–∏

**–°—Ç–∞—Ç—É—Å:** –û–¢–ö–†–´–¢–û
**–§–∏–∫—Å:** –î–æ–±–∞–≤–∏—Ç—å heartbeat –º–µ—Ö–∞–Ω–∏–∑–º—ã, —Ç–∞–π–º–∞—É—Ç—ã

---

### 6. Task.WhenAll –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –Ω–∞ –º–µ–¥–ª–µ–Ω–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–∞—Ö

**–§–∞–π–ª:** [FleckWebSocketServer.cs:56-81](../collections/src/SpreadAggregator.Infrastructure/Services/FleckWebSocketServer.cs#L56-L81)

```csharp
var tasks = new List<Task>();
foreach (var socket in socketsSnapshot)
{
    tasks.Add(socket.Send(message));
}
return Task.WhenAll(tasks);  // –ñ–î–ï–¢ –í–°–ï–•, –≤–∫–ª—é—á–∞—è –º–µ–¥–ª–µ–Ω–Ω—ã—Ö!
```

**–ü—Ä–æ–±–ª–µ–º–∞:**
- 1 –º–µ–¥–ª–µ–Ω–Ω—ã–π –±—Ä–∞—É–∑–µ—Ä (500ms) –∑–∞–º–æ—Ä–∞–∂–∏–≤–∞–µ—Ç –≤–µ—Å—å broadcast
- –í–µ—Å—å OrchestrationService callback –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è
- –î–∞–Ω–Ω—ã–µ –æ—Ç –±–∏—Ä–∂ –Ω–∞—á–∏–Ω–∞—é—Ç –Ω–∞–∫–∞–ø–ª–∏–≤–∞—Ç—å—Å—è –≤ Unbounded Channels

**–°—Ç–∞—Ç—É—Å:** –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô
**–§–∏–∫—Å:** Per-socket queues —Å timeout/drop –º–µ—Ö–∞–Ω–∏–∑–º–æ–º

---

## üü° –°–†–ï–î–ù–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢ (P2)

### 7. ParquetDataWriter –±—É—Ñ–µ—Ä—ã

**–§–∞–π–ª:** [ParquetDataWriter.cs:163-164](../collections/src/SpreadAggregator.Infrastructure/Services/ParquetDataWriter.cs#L163-L164)

**–ü—Ä–æ–±–ª–µ–º–∞:**
- Dictionary[hourly_partition, List<Data>]
- Batch size 1000, –Ω–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞—Ä—Ç–∏—Ü–∏–π –Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–æ
- 8000 –ø–∞—Ä—Ç–∏—Ü–∏–π √ó 1000 –∑–∞–ø–∏—Å–µ–π = **200-300 MB**

**–†–∏—Å–∫:** –°–†–ï–î–ù–ò–ô (–µ—Å—Ç—å flush –º–µ—Ö–∞–Ω–∏–∑–º)

---

### 8. JSON —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è - –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ

**–û–±—â–∞—è –ø—Ä–æ–±–ª–µ–º–∞:** **6.6 GB/hour** –∏–∑–±—ã—Ç–æ—á–Ω—ã—Ö –∞–ª–ª–æ–∫–∞—Ü–∏–π

**Charts (Python):**
- json.dumps() —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞
- 5√ó –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ DataFrame –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ
- **5.4 GB/hour**

**Collections (C#):**
- 8√ó –∏—Ç–µ—Ä–∞—Ü–∏–π Select().ToArray() –≤–º–µ—Å—Ç–æ 1
- List.ToList() –∫–æ–ø–∏—Ä—É–µ—Ç —Å–ø–∏—Å–æ–∫ –Ω–∞ –∫–∞–∂–¥—ã–π broadcast
- **1.2 GB/hour**

**–§–∏–∫—Å:** orjson async, –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–π, ImmutableList

---

## –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –ü–†–û–ë–õ–ï–ú–´

### Event Handlers & Callbacks

| –ü—Ä–æ–±–ª–µ–º–∞ | –§–∞–π–ª | –†–∏—Å–∫ |
|----------|------|------|
| WebSocket task –Ω–µ –æ—Ç–º–µ–Ω—è–µ—Ç—Å—è –ø—Ä–∏ shutdown | server.py:229 | –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô |
| Fleck OnOpen captures factory ‚Üí circular ref | FleckWebSocketServer:30 | –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô |
| Event handlers += –±–µ–∑ -= | ExchangeClientBase:201 | –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô |
| Timer –Ω–µ disposed | RollingWindowService:16 | –í–´–°–û–ö–ò–ô |

### Threading & Async

| –ü—Ä–æ–±–ª–µ–º–∞ | –§–∞–π–ª | –†–∏—Å–∫ |
|----------|------|------|
| Fire-and-forget Task.WhenAll() –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω | OrchestrationService:168-169 | –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô |
| Race condition –Ω–∞ Dict (Python) | server.py:89-161 | –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô |
| Race condition –Ω–∞ List (C#) | RollingWindowService:49-52 | –í–´–°–û–ö–ò–ô |

---

## –°–í–û–î–ù–ê–Ø –¢–ê–ë–õ–ò–¶–ê –ü–ê–ú–Ø–¢–ò

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –¢–∏–ø | –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ | –û—á–∏—Å—Ç–∫–∞ | –†–∏—Å–∫ OOM |
|-----------|-----|-----------|-------------|---------|----------|
| RawDataChannel | Channel | **‚àû** | –ù–ï–¢ | –ù–ï–¢ | üî¥ 100% |
| RollingWindowChannel | Channel | **‚àû** | –ù–ï–¢ | –ù–ï–¢ | üî¥ 100% |
| _allSymbolInfo | List | **‚àû** | –ù–ï–¢ | –ù–ï–¢ | üî¥ 90% |
| MOCK_OPPORTUNITIES | DataFrame | 2-4 GB | –ù–ï–¢ | –ù–ï–¢ | üî¥ 80% |
| RollingWindow.windows | Dict/ConcurrentDict | 10-50 GB | TTL 1h | Timer | üü† 60% |
| _allSockets (dead) | List | 200+ MB | Active | OnClose | üü† 70% |
| ParquetDataWriter buffers | Dict | 200-300 MB | Batch 1k | Hourly | üü° 30% |

---

## FAILURE SCENARIO

**Production Overload (—Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π):**

```
14:00 - –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
  ‚îú‚îÄ 8 –±–∏—Ä–∂ √ó 1000 –ø–∞—Ä = 100K+ messages/sec
  ‚îú‚îÄ 50 –±—Ä–∞—É–∑–µ—Ä–æ–≤ –ø–æ–¥–∫–ª—é—á–µ–Ω–æ
  ‚îî‚îÄ Memory: 500 MB

14:30 - 5 –º–µ–¥–ª–µ–Ω–Ω—ã—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤
  ‚îú‚îÄ BroadcastRealtimeAsync –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è –Ω–∞ Task.WhenAll
  ‚îú‚îÄ OrchestrationService callbacks –∑–∞–º–µ–¥–ª—è—é—Ç—Å—è
  ‚îî‚îÄ Unbounded Channels –Ω–∞—á–∏–Ω–∞—é—Ç —Ä–∞—Å—Ç–∏

14:35 - –ù–∞–∫–æ–ø–ª–µ–Ω–∏–µ
  ‚îú‚îÄ RawDataChannel: 47M –æ–±—ä–µ–∫—Ç–æ–≤ = 9.4 GB
  ‚îú‚îÄ ParquetDataWriter –æ—Ç—Å—Ç–∞–µ—Ç
  ‚îî‚îÄ Memory: 500 MB ‚Üí 2 GB ‚Üí 10 GB

14:40 - OOM CRASH
  ‚îú‚îÄ OutOfMemoryException
  ‚îú‚îÄ Collections –ø–∞–¥–∞–µ—Ç
  ‚îî‚îÄ Charts —Ç–µ—Ä—è–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ

14:45 - Cascade Failure
  ‚îú‚îÄ –ë—Ä–∞—É–∑–µ—Ä—ã —Ç–µ—Ä—è—é—Ç –¥–∞–Ω–Ω—ã–µ
  ‚îú‚îÄ Charts –Ω–µ –º–æ–∂–µ—Ç –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è (Collections –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç)
  ‚îî‚îÄ –õ–æ–≥–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã ObjectDisposedException + OOM errors
```

**–í—Ä–µ–º—è –¥–æ OOM:** 40 –º–∏–Ω—É—Ç –ø—Ä–∏ –ø–æ–ª–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–µ

---

## –ü–†–ò–û–†–ò–¢–ï–¢–´ –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø

### üî• IMMEDIATE (1-2 –¥–Ω—è)

1. **–ó–∞–º–µ–Ω–∏—Ç—å Unbounded ‚Üí Bounded Channels** (4 —á–∞—Å–∞)
   - Impact: –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç 100% OOM crashes
   - Risk: Low (–ª–µ–≥–∫–æ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è)

2. **–î–µ–¥—É–ø–ª–∏—Ü–∏—Ä–æ–≤–∞—Ç—å _allSymbolInfo** (1 —á–∞—Å)
   - Impact: –£—Å—Ç—Ä–∞–Ω—è–µ—Ç —É—Ç–µ—á–∫—É –ø—Ä–∏ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è—Ö
   - Risk: Very Low

3. **–û—á–∏—Å—Ç–∏—Ç—å MOCK_OPPORTUNITIES** (30 –º–∏–Ω)
   - Impact: –û—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç 2-4 GB
   - Risk: None

### üü† SHORT-TERM (1-2 –Ω–µ–¥–µ–ª–∏)

4. **–î–æ–±–∞–≤–∏—Ç—å heartbeat –≤ WebSocket** (8 —á–∞—Å–æ–≤)
5. **–ò—Å–ø—Ä–∞–≤–∏—Ç—å Task.WhenAll –±–ª–æ–∫–∏—Ä–æ–≤–∫—É** (12 —á–∞—Å–æ–≤)
6. **–ü—Ä–∏–º–µ–Ω–∏—Ç—å PROPOSAL-2025-0003** (2 —á–∞—Å–∞)

### üü° LONG-TERM (1-2 –º–µ—Å—è—Ü–∞)

7. **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å JSON —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—é** (9 —á–∞—Å–æ–≤)
8. **–ò—Å–ø—Ä–∞–≤–∏—Ç—å event handlers —É—Ç–µ—á–∫–∏** (16 —á–∞—Å–æ–≤)
9. **–î–æ–±–∞–≤–∏—Ç—å monitoring & metrics** (24 —á–∞—Å–∞)

---

## –î–û–ö–£–ú–ï–ù–¢–ò–†–û–í–ê–ù–ù–´–ï ISSUES

–°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ proposals:
- [PROPOSAL-2025-0002](../collections/docs/proposals/PROPOSAL-2025-0002-FixWebSocketRaceCondition.md)
- [PROPOSAL-2025-0003](../collections/docs/proposals/PROPOSAL-2025-0003-FixWebSocketRaceCondition-Simple.md) ‚úÖ –ì–û–¢–û–í–û
- [WebSocket Stability Analysis](../collections/docs/websocket_stability_analysis.md)

---

## –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï

**–°–∏—Å—Ç–µ–º–∞ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏:**
- 3 –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ —Å –Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º —Ä–æ—Å—Ç–æ–º –ø–∞–º—è—Ç–∏
- 8 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —É—Ç–µ—á–µ–∫ –≤ event handlers –∏ –∑–∞–¥–∞—á–∞—Ö
- –í—Ä–µ–º—è –¥–æ OOM: 40 –º–∏–Ω—É—Ç - 24 —á–∞—Å–∞ (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –Ω–∞–≥—Ä—É–∑–∫–∏)

**–ù–µ–º–µ–¥–ª–µ–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è —Ç—Ä–µ–±—É—é—Ç—Å—è –≤ —Ç–µ—á–µ–Ω–∏–µ 1-2 –¥–Ω–µ–π.**

**ROI –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:**
- 13.5 —á–∞—Å–æ–≤ —Ä–∞–±–æ—Ç—ã ‚Üí –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ 99% OOM crashes
- –≠–∫–æ–Ω–æ–º–∏—è: ~82% –ø–∞–º—è—Ç–∏ (6.6 GB ‚Üí 1.15 GB/hour)
- –°—Ç–æ–∏–º–æ—Å—Ç—å –ø—Ä–æ—Å—Ç–æ—è vs —Å—Ç–æ–∏–º–æ—Å—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è: 100:1

---

**–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:**
1. ‚úÖ –ê–Ω–∞–ª–∏–∑ –∑–∞–≤–µ—Ä—à–µ–Ω
2. ‚è≠Ô∏è –ê—É–¥–∏—Ç —Ä–∞—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
3. ‚è≠Ô∏è –°–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞–Ω–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π
4. ‚è≠Ô∏è –ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏—è –∏ –∏–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è
